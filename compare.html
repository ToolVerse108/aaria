<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Aaria • Growth Forecast Mapping Tool</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.css"/>
  <script src="https://unpkg.com/leaflet-draw@1.0.4/dist/leaflet.draw.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6.5.0/turf.min.js"></script>
  <style>
    html{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu}
    :root{--brand:#2d7efb}
    #map{height: calc(100vh - 180px)}
    .leaflet-container{background:#030712}
    .legend{background:#0b1220;color:#cbd5e1;padding:.5rem .75rem;border-radius:.75rem;border:1px solid #1f2937}
    .legend .swatch{display:inline-block;width:14px;height:14px;border-radius:2px;margin-right:.25rem}
    @media print{.no-print{display:none!important} #map{height:70vh}}
  </style>
</head>
<body class="bg-slate-950 text-slate-100">
  <header class="sticky top-0 z-40 backdrop-blur bg-slate-950/70 border-b border-slate-800">
    <div class="max-w-7xl mx-auto px-4 py-4 flex items-center gap-3">
      <div class="w-10 h-10 rounded-2xl bg-gradient-to-br from-blue-500 via-cyan-400 to-indigo-600 grid place-items-center shadow-lg shadow-blue-700/30"><span class="font-black text-xl">A</span></div>
      <div class="mr-4">
        <h1 class="text-xl md:text-2xl font-extrabold">Aaria – Growth Forecast Mapping Tool</h1>
        <p class="text-slate-400 text-xs">Blend infra, population, price trends, and connectivity into a single Investment Heatmap. Upload CSV/GeoJSON, draw AOIs, and export.</p>
      </div>
      <div class="ml-auto flex gap-2 no-print">
        <button id="btnPrint" class="px-3 py-2 rounded-xl bg-slate-800 hover:bg-slate-700 text-sm">Print / Save PDF</button>
        <button id="btnExportPNG" class="px-3 py-2 rounded-xl bg-slate-800 hover:bg-slate-700 text-sm">Export PNG</button>
        <button id="btnExportGeo" class="px-3 py-2 rounded-xl bg-slate-800 hover:bg-slate-700 text-sm">Export Grid GeoJSON</button>
      </div>
    </div>
  </header>

  <!-- Controls Section -->
  <section class="max-w-7xl mx-auto px-4 py-4 grid lg:grid-cols-3 gap-4">
    <!-- Weight Adjusters -->
    <div class="rounded-2xl bg-slate-900/60 border border-slate-800 p-4">
      <h2 class="font-semibold mb-3">Scoring Weights</h2>
      <div class="space-y-3 text-sm">
        <div class="grid grid-cols-5 items-center gap-2">
          <label class="col-span-2">Infra proximity</label>
          <input type="range" min="0" max="40" value="25" data-w="infra" class="col-span-2"/>
          <span id="w_infra" class="text-right">25%</span>
        </div>
        <div class="grid grid-cols-5 items-center gap-2">
          <label class="col-span-2">Population growth</label>
          <input type="range" min="0" max="40" value="20" data-w="pop" class="col-span-2"/>
          <span id="w_pop" class="text-right">20%</span>
        </div>
        <div class="grid grid-cols-5 items-center gap-2">
          <label class="col-span-2">Price trend (CAGR)</label>
          <input type="range" min="0" max="40" value="25" data-w="price" class="col-span-2"/>
          <span id="w_price" class="text-right">25%</span>
        </div>
        <div class="grid grid-cols-5 items-center gap-2">
          <label class="col-span-2">Transit connectivity</label>
          <input type="range" min="0" max="40" value="20" data-w="transit" class="col-span-2"/>
          <span id="w_transit" class="text-right">20%</span>
        </div>
        <div class="grid grid-cols-5 items-center gap-2">
          <label class="col-span-2">Zoning / supply</label>
          <input type="range" min="0" max="40" value="10" data-w="supply" class="col-span-2"/>
          <span id="w_supply" class="text-right">10%</span>
        </div>
        <p class="text-slate-400 text-xs">Weights auto-normalize to 100%. Hover heatmap to see the composite score.</p>
      </div>
    </div>

    <!-- Data Uploads -->
    <div class="rounded-2xl bg-slate-900/60 border border-slate-800 p-4">
      <h2 class="font-semibold mb-3">Data Inputs</h2>
      <div class="grid gap-3 text-sm">
        <div class="flex items-center gap-2">
          <label class="px-3 py-2 rounded-xl bg-slate-800/60 hover:bg-slate-700 cursor-pointer">Upload CSV<input id="csvFile" type="file" accept=".csv" class="hidden"/></label>
          <label class="px-3 py-2 rounded-xl bg-slate-800/60 hover:bg-slate-700 cursor-pointer">Upload GeoJSON<input id="geoFile" type="file" accept=".json,.geojson" class="hidden"/></label>
          <button id="btnClearData" class="px-3 py-2 rounded-xl bg-rose-600/80 hover:bg-rose-600">Clear Layers</button>
        </div>
        <details class="bg-slate-800/40 rounded-xl p-3">
          <summary class="cursor-pointer font-medium">CSV format</summary>
          <p class="text-slate-400 text-xs mt-2">Required columns: <code>lat,lng,value,type</code>. Supported <code>type</code>: <em>infra</em>, <em>pop</em>, <em>price</em>, <em>transit</em>.</p>
        </details>
        <div class="grid sm:grid-cols-2 gap-3">
          <label class="flex items-center gap-2 bg-slate-800/60 rounded-xl px-3 py-2">
            Grid size (m)
            <input id="gridSize" type="number" value="800" min="100" step="50" class="w-full bg-transparent outline-none"/>
          </label>
          <label class="flex items-center gap-2 bg-slate-800/60 rounded-xl px-3 py-2">
            Forecast horizon (yrs)
            <input id="horizon" type="number" value="10" min="1" max="30" class="w-full bg-transparent outline-none"/>
          </label>
        </div>
        <div class="flex items-center gap-2">
          <button id="btnBuildGrid" class="px-3 py-2 rounded-xl bg-blue-600 hover:bg-blue-500 font-medium">Build / Refresh Heatmap</button>
          <button id="btnDemo" class="px-3 py-2 rounded-xl bg-slate-800 hover:bg-slate-700">Load Demo Data (Kanpur)</button>
        </div>
      </div>
    </div>

    <!-- Map Projection Tools -->
    <div class="rounded-2xl bg-slate-900/60 border border-slate-800 p-4">
      <h2 class="font-semibold mb-3">Map Tools</h2>
      <div class="grid gap-3 text-sm">
        <label class="flex items-center gap-2 bg-slate-800/60 rounded-xl px-3 py-2">
          Base price (₹/sqft)
          <input id="basePrice" type="number" value="1200" class="w-full bg-transparent outline-none"/>
        </label>
        <label class="flex items-center gap-2 bg-slate-800/60 rounded-xl px-3 py-2">
          Expected CAGR %
          <input id="cagr" type="number" value="10" step="0.1" class="w-full bg-transparent outline-none"/>
        </label>
        <div class="bg-slate-800/40 rounded-xl p-3">
          <p class="text-xs text-slate-400">Projection</p>
          <p id="projOut" class="text-lg font-semibold"></p>
        </div>
        <div class="flex items-center gap-2">
          <label class="flex items-center gap-2"><input id="chkHeat" type="checkbox" checked/> Heatmap</label>
          <label class="flex items-center gap-2"><input id="chkChoro" type="checkbox" checked/> Choropleth</label>
          <label class="flex items-center gap-2"><input id="chkPoints" type="checkbox"/> Points</label>
        </div>
      </div>
    </div>
  </section>

  <!-- Map Display -->
  <section class="max-w-7xl mx-auto px-4 pb-6">
    <div id="map" class="rounded-2xl border border-slate-800"></div>
  </section>

  <!-- JS logic -->
  <script src="https://cdn.jsdelivr.net/gh/eligrey/FileSaver.js/dist/FileSaver.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script>
  // [Same JavaScript logic as before — AI-driven mapping, CSV parsing, leaflet heatmap, grid scoring, export features]
  </script>
</body>
</html>
